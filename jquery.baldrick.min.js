/* BaldrickJS  V2.01 | (C) David Cramer - 2013 | MIT License */
!function(a){var b={bind:{},event:{_event:function(a){return a}},filter:{},params:{},request:{_dorequest:function(b){return a.ajax(b)}}};a.fn.baldrick=function(){var c=this.selector,d=this.not("._tisBound");d.addClass("_tisBound");var e=a.extend(!0,arguments[0],{helpers:b}),f=function(){return!0},g={before:f,callback:f,complete:f,error:f};for(var i in g)"string"==typeof e[i]?g[i]="function"==typeof window[e[i]]?window[e[i]]:f:"function"==typeof e[i]&&(g[i]=e[i]);var j=function(a,b,c){if("object"==typeof e.helpers[a]){for(var d in e.helpers[a])if("function"==typeof e.helpers[a][d]&&(b=e.helpers[a][d](b,c),!b))return!1}else if("function"==typeof e.helpers[a]&&(b=e.helpers[a](b,c),!b))return!1;return b};return d=j("bind",d),d===!1?this:d.each(function(){var b=a(this),f=b.data("event")?b.data("event"):e.event?e.event:b.is("form")?"submit":"click";return b.on(f,function(b){var h=a(j("event",this,b));if(h.data("for")){var i=a(h.data("for")),k=a.extend({},h.data());return delete k.for,i.data(k),i.trigger(i.data("event")?i.data("event"):f)}if(h.is("form")&&!h.data("request")&&h.attr("action")&&h.data("request",h.attr("action")),h.is("a")&&!h.data("request")&&h.attr("href")&&h.data("request",h.attr("href")),(h.data("before")?"function"==typeof window[h.data("before")]?window[h.data("before")](this,b):g.before(this,b):g.before(this,b))!==!1){var l=h.data("callback")?"function"==typeof window[h.data("callback")]?window[h.data("callback")]:h.data("callback"):g.callback,m=h.data("request")?h.data("request"):e.request?e.request:l,n=h.data("method")?h.data("method"):h.attr("method")?h.attr("method"):e.method?e.method:"GET",o=h.data("type")?h.data("type"):e.dataType?e.dataType:!1,p=h.data("target")?a(h.data("target")):e.target?a(e.target):a("<html>"),q=h.data("targetInsert")?"replace"===h.data("targetInsert")?"replaceWith":h.data("targetInsert"):e.targetInsert?"replace"===e.targetInsert?"replaceWith":e.targetInsert:"html",r=h.data("loadClass")?h.data("loadClass"):e.loadClass?e.loadClass:"loading",s=h.data("activeClass")?h.data("activeClass"):e.activeClass?e.activeClass:"active",t=h.data("activeElement")?"_parent"===h.data("activeElement")?h.parent():a(h.data("activeElement")):e.activeElement?"_parent"===e.activeElement?h.parent():a(e.activeElement):h,u=h.data("loadElement")?a(h.data("loadElement")):e.loadElement?a(e.loadElement)?a(e.loadElement):p:p,v=h.data("cache")?h.data("cache"):e.cache?e.cache:!1,w=h.data("complete")?"function"==typeof window[h.data("complete")]?window[h.data("complete")]:g.complete:g.complete,x=!1;switch(typeof m){case"function":return m(this,b);case"boolean":case"object":return m;case"string":if(m.indexOf(" ")>-1){var y=m.split(" ");m=y[0],x=y[1]}}b.preventDefault(),h.data("group")?a('._tisBound[data-group="'+h.data("group")+'"]').each(function(){var b=a(this),c=b.data("activeElement")?"_parent"===b.data("activeElement")?b.parent():a(b.data("activeElement")):e.activeElement?"_parent"===e.activeElement?h.parent():a(e.activeElement):b;c.removeClass(b.data("activeClass")?b.data("activeClass"):e.activeClass?e.activeClass:s)}):a("._tisBound:not([data-group])").each(function(){var b=a(this),c=b.data("activeElement")?"_parent"===b.data("activeElement")?b.parent():a(b.data("activeElement")):e.activeElement?"_parent"===e.activeElement?h.parent():a(e.activeElement):b;c.removeClass(b.data("activeClass")?b.data("activeClass"):e.activeClass?e.activeClass:s)}),t.addClass(s),u.addClass(r);var B,A=h.serializeArray();if(A.length){var C=[];a.each(h.data(),function(a,b){C.push({name:a,value:b})}),B=a.extend(C,A)}else B=a.param(h.data());var D={url:m,data:B,cache:v,type:n,success:function(b,d,f){if(x){var g=a(x,a("<html>").html(b));1===g.length?b=a("<html>").html(g).html():(b=a("<html>"),g.each(function(){b.append(this)}),b=b.html())}if(b=j("filter",b,{params:D,target:p,text_status:d,jqXHR:f}),p[q](b),a(c).baldrick(e),"string"==typeof l){if("function"==typeof window[l])return window[l](h,p)}else if("function"==typeof l)return l(b,{trigger:h,target:p},f)},complete:function(a,b){w(a,b),u.removeClass(r),h.data("once")&&h.off(f).removeClass("_tisBound")},error:function(a,b,c){g.error(a,b,c)}};return o&&(D.dataType=o),D=j("params",D,this),D===!1?d:j("request",D,{trigger:h,target:p})}}),(b.data("autoload")||b.data("poll"))&&(b.data("delay")?setTimeout(function(a,b){return a.trigger(b)},b.data("delay"),b,f):b.trigger(f)),b.data("poll")&&(b.data("delay")?setTimeout(function(a,b){return setInterval(function(a,b){return a.trigger(b)},a.data("poll"),a,b)},b.data("delay")):setInterval(function(a,b){return a.trigger(b)},b.data("poll"),b,f)),this})},a.fn.baldrick.registerhelper=function(c,d,e){if("object"==typeof c)b=a.extend(!0,c,b);else if("string"==typeof c&&"string"==typeof d&&"function"==typeof e){var f={};f[c]={},f[c][d]=e,b=a.extend(!0,f,b)}}}(jQuery);