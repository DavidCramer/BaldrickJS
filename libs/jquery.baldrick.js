/* BaldrickJS  V2.01 | (C) David Cramer - 2013 | MIT License */
!function(a){var b={bind:{},event:{_event:function(a){return a}},filter:{_totarget:function(a){a.params.target&&a.params.target[a.params.targetInsert](a.data)}},request:{_dorequest:function(b){return a.ajax(b.request)}},request_complete:{_docomplete:function(a){a.params.complete(a.jqxhr,a.textStatus),a.params.loadElement.removeClass(a.params.loadClass)}},request_error:{_doerror:function(a){a.params.complete(xhr,ts)}}};a.fn.baldrick=function(){var c=this.selector,d=this.not("._tisBound");d.addClass("_tisBound");var e=a.extend(!0,arguments[0],{helpers:b}),f=function(){return!0},g={before:f,callback:f,complete:f,error:f};for(var i in g)"string"==typeof e[i]?g[i]="function"==typeof window[e[i]]?window[e[i]]:f:"function"==typeof e[i]&&(g[i]=e[i]);var j=function(a,b,c){var d;if("object"==typeof e.helpers[a]){for(var f in e.helpers[a])if("function"==typeof e.helpers[a][f]&&(d=e.helpers[a][f](b,c),"undefined"!=typeof d&&(b=d),b===!1))return!1}else if("function"==typeof e.helpers[a]&&(d=e.helpers[a](b,c),"undefined"!=typeof d&&(b=d),!b))return!1;return b};return d=j("bind",d),d===!1?this:j("ready",d.each(function(){var b=a(this),f=b.data("event")?b.data("event"):e.event?e.event:b.is("form")?"submit":"click";return b.on(f,function(b){var h=a(j("event",this,b));if(h.data("for")){var i=a(h.data("for")),k=a.extend({},h.data());return delete k.for,i.data(k),i.trigger(i.data("event")?i.data("event"):f)}if(h.is("form")&&!h.data("request")&&h.attr("action")&&h.data("request",h.attr("action")),h.is("a")&&!h.data("request")&&h.attr("href")&&h.data("request",h.attr("href")),(h.data("before")?"function"==typeof window[h.data("before")]?window[h.data("before")](this,b):g.before(this,b):g.before(this,b))!==!1){var l={trigger:h,callback:h.data("callback")?"function"==typeof window[h.data("callback")]?window[h.data("callback")]:h.data("callback"):g.callback,method:h.data("method")?h.data("method"):h.attr("method")?h.attr("method"):e.method?e.method:"GET",dataType:h.data("type")?h.data("type"):e.dataType?e.dataType:!1,target:h.data("target")?a(h.data("target")):e.target?a(e.target):a("<html>"),targetInsert:h.data("targetInsert")?"replace"===h.data("targetInsert")?"replaceWith":h.data("targetInsert"):e.targetInsert?"replace"===e.targetInsert?"replaceWith":e.targetInsert:"html",loadClass:h.data("loadClass")?h.data("loadClass"):e.loadClass?e.loadClass:"loading",activeClass:h.data("activeClass")?h.data("activeClass"):e.activeClass?e.activeClass:"active",activeElement:h.data("activeElement")?"_parent"===h.data("activeElement")?h.parent():a(h.data("activeElement")):e.activeElement?"_parent"===e.activeElement?h.parent():a(e.activeElement):h,cache:h.data("cache")?h.data("cache"):e.cache?e.cache:!1,complete:h.data("complete")?"function"==typeof window[h.data("complete")]?window[h.data("complete")]:g.complete:g.complete,resultSelector:!1};switch(l.url=h.data("request")?h.data("request"):e.request?e.request:l.callback,l.loadElement=h.data("loadElement")?a(h.data("loadElement")):e.loadElement?a(e.loadElement)?a(e.loadElement):l.target:l.target,typeof l.url){case"function":return l.url(this,b);case"boolean":case"object":return l.url;case"string":if(l.url.indexOf(" ")>-1){var m=l.url.split(" ");l.url=m[0],l.resultSelector=m[1]}}if(l=j("params",l),l===!1)return!1;b.preventDefault(),h.data("group")?a('._tisBound[data-group="'+h.data("group")+'"]').each(function(){var b=a(this),c=b.data("activeElement")?"_parent"===b.data("activeElement")?b.parent():a(b.data("activeElement")):e.activeElement?"_parent"===e.activeElement?h.parent():a(e.activeElement):b;c.removeClass(b.data("activeClass")?b.data("activeClass"):e.activeClass?e.activeClass:l.activeClass)}):a("._tisBound:not([data-group])").each(function(){var b=a(this),c=b.data("activeElement")?"_parent"===b.data("activeElement")?b.parent():a(b.data("activeElement")):e.activeElement?"_parent"===e.activeElement?h.parent():a(e.activeElement):b;c.removeClass(b.data("activeClass")?b.data("activeClass"):e.activeClass?e.activeClass:l.activeClass)}),l.activeElement.addClass(l.activeClass),l.loadElement.addClass(l.loadClass);var p,o=h.serializeArray();if(o.length){var q=[];a.each(h.data(),function(a,b){q.push({name:a,value:b})}),p=a.extend(q,o)}else p=a.param(h.data());var r={url:l.url,data:p,cache:l.cache,type:l.method,success:function(b,d,f){if(l.resultSelector){var g=a(l.resultSelector,a("<html>").html(b));1===g.length?b=a("<html>").html(g).html():(b=a("<html>"),g.each(function(){b.append(this)}),b=b.html())}if(j("filter",{data:b,request:r,params:l}),a(c).baldrick(e),"string"==typeof cb){if("function"==typeof window[cb])return window[cb](h,l.target)}else if("function"==typeof cb)return cb(b,{trigger:h,target:l.target},f)},complete:function(a,b){j("request_complete",{jqxhr:a,textStatus:b,request:r,params:l}),h.data("once")&&h.off(f).removeClass("_tisBound")},error:function(a,b,c){j("request_error",{jqxhr:a,textStatus:b,error:c,request:r,params:l})}};return l.dataType&&(r.dataType=l.dataType),r=j("request_params",r,l),r===!1?d:j("request",{request:r,params:l})}}),(b.data("autoload")||b.data("poll"))&&(b.data("delay")?setTimeout(function(a,b){return a.trigger(b)},b.data("delay"),b,f):b.trigger(f)),b.data("poll")&&(b.data("delay")?setTimeout(function(a,b){return setInterval(function(a,b){return a.trigger(b)},a.data("poll"),a,b)},b.data("delay")):setInterval(function(a,b){return a.trigger(b)},b.data("poll"),b,f)),this}))},a.fn.baldrick.registerhelper=function(c,d,e){if("object"==typeof c)b=a.extend(!0,c,b);else if("string"==typeof c&&"string"==typeof d&&"function"==typeof e){var f={};f[c]={},f[c][d]=e,b=a.extend(!0,f,b)}}}(jQuery);