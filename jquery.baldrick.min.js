/* BaldrickJS  V2.01 | (C) David Cramer - 2013 | MIT License */
!function(a){var b={bind:{},event:{_event:function(a){return a}},filter:{_totarget:function(a){a.params.target&&a.params.target[a.params.targetInsert](a.data)}},request:{_dorequest:function(b){return a.ajax(b.request)}},request_complete:{_docomplete:function(a){a.params.complete(a.jqxhr,a.textStatus),a.params.loadElement.removeClass(a.params.loadClass)}},request_error:{_doerror:function(a){a.params.complete(xhr,ts)}},refresh:{_dorefresh:function(b,c){a(c.triggerClass).baldrick(c)}}};a.fn.baldrick=function(){var c=this.selector,d=this.not("._tisBound");d.addClass("_tisBound");var e=a.extend(!0,arguments[0],{helpers:b},{triggerClass:c}),f=function(){return!0},g={before:f,callback:f,complete:f,error:f};for(var i in g)"string"==typeof e[i]?g[i]="function"==typeof window[e[i]]?window[e[i]]:f:"function"==typeof e[i]&&(g[i]=e[i]);var j=function(a,b,c){var d;if("object"==typeof e.helpers[a]){for(var f in e.helpers[a])if("function"==typeof e.helpers[a][f]&&(d=e.helpers[a][f](b,e,c),"undefined"!=typeof d&&(b=d),b===!1))return!1}else if("function"==typeof e.helpers[a]&&(d=e.helpers[a](b,e,c),"undefined"!=typeof d&&(b=d),!b))return!1;return b};return d=j("bind",d),d===!1?this:j("ready",d.each(function(){var b=a(this),c=b.data("event")?b.data("event"):e.event?e.event:b.is("form")?"submit":"click";return b.on(c,function(b){var f=a(j("event",this,b));if(f.data("for")){var h=a(f.data("for")),i=a.extend({},f.data());return delete i.for,h.data(i),h.trigger(h.data("event")?h.data("event"):c)}if(f.is("form")&&!f.data("request")&&f.attr("action")&&f.data("request",f.attr("action")),f.is("a")&&!f.data("request")&&f.attr("href")&&f.data("request",f.attr("href")),(f.data("before")?"function"==typeof window[f.data("before")]?window[f.data("before")](this,b):g.before(this,b):g.before(this,b))!==!1){var k={trigger:f,callback:f.data("callback")?"function"==typeof window[f.data("callback")]?window[f.data("callback")]:f.data("callback"):g.callback,method:f.data("method")?f.data("method"):f.attr("method")?f.attr("method"):e.method?e.method:"GET",dataType:f.data("type")?f.data("type"):e.dataType?e.dataType:!1,target:f.data("target")?a(f.data("target")):e.target?a(e.target):a("<html>"),targetInsert:f.data("targetInsert")?"replace"===f.data("targetInsert")?"replaceWith":f.data("targetInsert"):e.targetInsert?"replace"===e.targetInsert?"replaceWith":e.targetInsert:"html",loadClass:f.data("loadClass")?f.data("loadClass"):e.loadClass?e.loadClass:"loading",activeClass:f.data("activeClass")?f.data("activeClass"):e.activeClass?e.activeClass:"active",activeElement:f.data("activeElement")?"_parent"===f.data("activeElement")?f.parent():a(f.data("activeElement")):e.activeElement?"_parent"===e.activeElement?f.parent():a(e.activeElement):f,cache:f.data("cache")?f.data("cache"):e.cache?e.cache:!1,complete:f.data("complete")?"function"==typeof window[f.data("complete")]?window[f.data("complete")]:g.complete:g.complete,resultSelector:!1};switch(k.url=f.data("request")?f.data("request"):e.request?e.request:k.callback,k.loadElement=f.data("loadElement")?a(f.data("loadElement")):e.loadElement?a(e.loadElement)?a(e.loadElement):k.target:k.target,typeof k.url){case"function":return k.url(this,b);case"boolean":case"object":return k.url;case"string":if(k.url.indexOf(" ")>-1){var l=k.url.split(" ");k.url=l[0],k.resultSelector=l[1]}}if(k=j("params",k),k===!1)return!1;b.preventDefault(),f.data("group")?a('._tisBound[data-group="'+f.data("group")+'"]').each(function(){var b=a(this),c=b.data("activeElement")?"_parent"===b.data("activeElement")?b.parent():a(b.data("activeElement")):e.activeElement?"_parent"===e.activeElement?f.parent():a(e.activeElement):b;c.removeClass(b.data("activeClass")?b.data("activeClass"):e.activeClass?e.activeClass:k.activeClass)}):a("._tisBound:not([data-group])").each(function(){var b=a(this),c=b.data("activeElement")?"_parent"===b.data("activeElement")?b.parent():a(b.data("activeElement")):e.activeElement?"_parent"===e.activeElement?f.parent():a(e.activeElement):b;c.removeClass(b.data("activeClass")?b.data("activeClass"):e.activeClass?e.activeClass:k.activeClass)}),k.activeElement.addClass(k.activeClass),k.loadElement.addClass(k.loadClass);var o,n=f.serializeArray();if(n.length){var p=[];a.each(f.data(),function(a,b){p.push({name:a,value:b})}),o=a.extend(p,n)}else o=a.param(f.data());var q={url:k.url,data:o,cache:k.cache,type:k.method,success:function(b,c,d){if(k.resultSelector){var e=a(k.resultSelector,a("<html>").html(b));1===e.length?b=a("<html>").html(e).html():(b=a("<html>"),e.each(function(){b.append(this)}),b=b.html())}if(j("filter",{data:b,request:q,params:k}),"string"==typeof cb){if("function"==typeof window[cb])return window[cb](f,k.target)}else if("function"==typeof cb)return cb(b,{trigger:f,target:k.target},d)},complete:function(a,b){j("request_complete",{jqxhr:a,textStatus:b,request:q,params:k}),j("refresh",{jqxhr:a,textStatus:b,request:q,params:k}),f.data("once")&&f.off(c).removeClass("_tisBound")},error:function(a,b,c){j("request_error",{jqxhr:a,textStatus:b,error:c,request:q,params:k})}};return k.dataType&&(q.dataType=k.dataType),q=j("request_params",q,k),q===!1?d:j("request",{request:q,params:k})}}),(b.data("autoload")||b.data("poll"))&&(b.data("delay")?setTimeout(function(a,b){return a.trigger(b)},b.data("delay"),b,c):b.trigger(c)),b.data("poll")&&(b.data("delay")?setTimeout(function(a,b){return setInterval(function(a,b){return a.trigger(b)},a.data("poll"),a,b)},b.data("delay")):setInterval(function(a,b){return a.trigger(b)},b.data("poll"),b,c)),this}))},a.fn.baldrick.registerhelper=function(c,d,e){if("object"==typeof c)b=a.extend(!0,c,b);else if("string"==typeof c&&"string"==typeof d&&"function"==typeof e){var f={};f[c]={},f[c][d]=e,b=a.extend(!0,f,b)}},jQuery(function(a){a(".baldrick").baldrick()})}(jQuery);