/* BaldrickJS  V2.01 | (C) David Cramer - 2013 | MIT License */
!function(a){var b={},c={bind:{},event:{_event:function(a){return a}},filter:{_totarget:function(a){if(a.params.target)if(a.params.target[a.params.targetInsert](a.data),"string"==typeof a.params.callback){if("function"==typeof window[a.params.callback])return window[a.params.callback](a)}else if("function"==typeof a.params.callback)return a.params.callback(a)}},request:{_dorequest:function(c){return c.request.url.indexOf("#_cache_")>-1&&"object"==typeof b[c.request.url.split("#_cache_")[1]]?{data:b[c.request.url.split("#_cache_")[1]]}:a.ajax(c.request)}},request_complete:{_docomplete:function(a){a.params.complete(a),a.params.loadElement.removeClass(a.params.loadClass)}},request_error:{_doerror:function(a){a.params.complete(a.jqxhr,a.textStatus)}},refresh:{_dorefresh:function(b,c){a(c.triggerClass).baldrick(c)}}};a.fn.baldrick=function(){var b=this.selector,d=this.not("._tisBound");d.addClass("_tisBound");var e=a.extend(!0,arguments[0],{helpers:c},{triggerClass:b}),f=function(){return!0},g={before:f,callback:!1,complete:f,error:f};for(var i in g)"string"==typeof e[i]?g[i]="function"==typeof window[e[i]]?window[e[i]]:f:"function"==typeof e[i]&&(g[i]=e[i]);var j=function(a,b,c){var d;if("object"==typeof e.helpers[a]){for(var f in e.helpers[a])if("function"==typeof e.helpers[a][f]&&(d=e.helpers[a][f](b,e,c),"undefined"!=typeof d&&(b=d),b===!1))return!1}else if("function"==typeof e.helpers[a]&&(d=e.helpers[a](b,e,c),"undefined"!=typeof d&&(b=d),!b))return!1;return b};return d=j("bind",d),d===!1?this:j("ready",d.each(function(b){this.id||(this.id="baldrick_trigger_"+((new Date).getTime()+b));var c=a(this),f=c.data("event")?c.data("event"):e.event?e.event:c.is("form")?"submit":"click";return c.on(f,function(b){var c=a(j("event",this,b));if(c.data("for")){var h=a(c.data("for")),i=a.extend({},h.data(),c.data());return delete i["for"],h.data(i),h.trigger(h.data("event")?h.data("event"):f)}if(c.is("form")&&!c.data("request")&&c.attr("action")&&c.data("request",c.attr("action")),c.is("a")&&!c.data("request")&&c.attr("href")&&(c.attr("href").indexOf("#")<0?c.data("request",c.attr("href")):c.data("href",c.attr("href"))),(c.data("before")?"function"==typeof window[c.data("before")]?window[c.data("before")](this,b):g.before(this,b):g.before(this,b))!==!1){var k={trigger:c,callback:c.data("callback")?"function"==typeof window[c.data("callback")]?window[c.data("callback")]:c.data("callback"):g.callback,method:c.data("method")?c.data("method"):c.attr("method")?c.attr("method"):e.method?e.method:"GET",dataType:c.data("type")?c.data("type"):e.dataType?e.dataType:!1,target:c.data("target")?a(c.data("target")):e.target?a(e.target):a("<html>"),targetInsert:c.data("targetInsert")?"replace"===c.data("targetInsert")?"replaceWith":c.data("targetInsert"):e.targetInsert?"replace"===e.targetInsert?"replaceWith":e.targetInsert:"html",loadClass:c.data("loadClass")?c.data("loadClass"):e.loadClass?e.loadClass:"loading",activeClass:c.data("activeClass")?c.data("activeClass"):e.activeClass?e.activeClass:"active",activeElement:c.data("activeElement")?"_parent"===c.data("activeElement")?c.parent():a(c.data("activeElement")):e.activeElement?"_parent"===e.activeElement?c.parent():a(e.activeElement):c,cache:c.data("cache")?c.data("cache"):e.cache?e.cache:!1,complete:c.data("complete")?"function"==typeof window[c.data("complete")]?window[c.data("complete")]:g.complete:g.complete,resultSelector:!1};if(k.url=c.data("request")?c.data("request"):e.request?e.request:k.callback,k.loadElement=c.data("loadElement")?a(c.data("loadElement")):e.loadElement?a(e.loadElement)?a(e.loadElement):k.target:k.target,k=j("params",k),k===!1)return!1;switch(typeof k.url){case"function":return k.url(this,b);case"boolean":case"object":return;case"string":if(k.url.indexOf(" ")>-1){var l=k.url.split(" ");k.url=l[0],k.resultSelector=l[1]}}b.preventDefault(),c.data("group")?a('._tisBound[data-group="'+c.data("group")+'"]').each(function(){var b=a(this),d=b.data("activeElement")?"_parent"===b.data("activeElement")?b.parent():a(b.data("activeElement")):e.activeElement?"_parent"===e.activeElement?c.parent():a(e.activeElement):b;d.removeClass(b.data("activeClass")?b.data("activeClass"):e.activeClass?e.activeClass:k.activeClass)}):a("._tisBound:not([data-group])").each(function(){var b=a(this),d=b.data("activeElement")?"_parent"===b.data("activeElement")?b.parent():a(b.data("activeElement")):e.activeElement?"_parent"===e.activeElement?c.parent():a(e.activeElement):b;d.removeClass(b.data("activeClass")?b.data("activeClass"):e.activeClass?e.activeClass:k.activeClass)}),k.activeElement.addClass(k.activeClass),k.loadElement.addClass(k.loadClass);var o,n=c.serializeArray(),p=c.data(),q=[];e.data&&(p=a.extend(e.data,p)),a.each(p,function(a,b){q.push({name:a,value:b}),a.indexOf("field")>-1&&q.push({name:a.substr(5).toLowerCase(),value:b})}),n.length&&a.each(n,function(a,b){q.push(b)}),o=a.param(q);var r={url:k.url,data:o,cache:k.cache,type:k.method,success:function(b){if(k.resultSelector)if("object"==typeof b){for(var e=k.resultSelector.replace(/\[/g,".").replace(/\]/g,"").split("."),f=b,g=0;g<e.length;g++)f=f[e[g]];b=f}else if("string"==typeof b){var h=a(k.resultSelector,a("<html>").html(b));1===h.length?b=a("<html>").html(h).html():(b=a("<html>"),h.each(function(){b.append(this)}),b=b.html())}var i=b;j("filter",{data:b,rawData:i,request:r,params:k})},complete:function(a,b){j("request_complete",{jqxhr:a,textStatus:b,request:r,params:k}),j("refresh",{jqxhr:a,textStatus:b,request:r,params:k}),c.data("once")&&c.off(f).removeClass("_tisBound")},error:function(a,b,c){j("request_error",{jqxhr:a,textStatus:b,error:c,request:r,params:k})}};if(k.dataType&&(r.dataType=k.dataType),r=j("request_params",r,k),r===!1)return d;var s=j("request",{request:r,params:k});if(s.data){var t=s.data,u=t;j("filter",{data:t,rawData:u,request:r,params:k}),j("request_complete",{jqxhr:!1,textStatus:!0,request:r,params:k}),j("refresh",{jqxhr:!1,textStatus:!0,request:r,params:k})}}}),(c.data("autoload")||c.data("poll"))&&(c.data("delay")?setTimeout(function(a,b){return a.trigger(b)},c.data("delay"),c,f):c.trigger(f)),c.data("poll")&&(c.data("delay")?setTimeout(function(a,b){return setInterval(function(a,b){return a.trigger(b)},a.data("poll"),a,b)},c.data("delay")):setInterval(function(a,b){return a.trigger(b)},c.data("poll"),c,f)),this}))},a.fn.baldrick.cacheObject=function(a,c){b[a]=c},a.fn.baldrick.registerhelper=function(b,d,e){if("object"==typeof b)c=a.extend(!0,b,c);else if("string"==typeof b&&"string"==typeof d&&"function"==typeof e){var f={};f[b]={},f[b][d]=e,c=a.extend(!0,f,c)}},jQuery(function(a){a(".baldrick").baldrick()})}(jQuery);